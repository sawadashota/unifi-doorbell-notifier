var H=Object.defineProperty;var W=(e,t,n)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var R=(e,t,n)=>(W(e,typeof t!="symbol"?t+"":t,n),n);import{_ as v,l as _,v as E,d as P,b as g,c as b,y as D}from"./vendor.2869d34b.js";import{j as u,a as O}from"./index.db03592b.js";function L(e,t){for(var n in t)e[n]=t[n];return e}function S(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var o in t)if(o!=="__source"&&e[o]!==t[o])return!0;return!1}function j(e){this.props=e}(j.prototype=new v).isPureReactComponent=!0,j.prototype.shouldComponentUpdate=function(e,t){return S(this.props,e)||S(this.state,t)};var $=_.__b;_.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),$&&$(e)};var z=_.__e;_.__e=function(e,t,n){if(e.then){for(var o,s=t;s=s.__;)if((o=s.__c)&&o.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),o.__c(e,t)}z(e,t,n)};var C=_.unmount;function y(){this.__u=0,this.t=null,this.__b=null}function T(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function m(){this.u=null,this.o=null}_.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),C&&C(e)},(y.prototype=new v).__c=function(e,t){var n=t.__c,o=this;o.t==null&&(o.t=[]),o.t.push(n);var s=T(o.__v),r=!1,i=function(){r||(r=!0,n.__R=null,s?s(a):a())};n.__R=i;var a=function(){if(!--o.__u){if(o.state.__e){var l=o.state.__e;o.__v.__k[0]=function w(c,d,h){return c&&(c.__v=null,c.__k=c.__k&&c.__k.map(function(N){return w(N,d,h)}),c.__c&&c.__c.__P===d&&(c.__e&&h.insertBefore(c.__e,c.__d),c.__c.__e=!0,c.__c.__P=h)),c}(l,l.__c.__P,l.__c.__O)}var f;for(o.setState({__e:o.__b=null});f=o.t.pop();)f.forceUpdate()}},p=t.__h===!0;o.__u++||p||o.setState({__e:o.__b=o.__v.__k[0]}),e.then(i,i)},y.prototype.componentWillUnmount=function(){this.t=[]},y.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),o=this.__v.__k[0].__c;this.__v.__k[0]=function r(i,a,p){return i&&(i.__c&&i.__c.__H&&(i.__c.__H.__.forEach(function(l){typeof l.__c=="function"&&l.__c()}),i.__c.__H=null),(i=L({},i)).__c!=null&&(i.__c.__P===p&&(i.__c.__P=a),i.__c=null),i.__k=i.__k&&i.__k.map(function(l){return r(l,a,p)})),i}(this.__b,n,o.__O=o.__P)}this.__b=null}var s=t.__e&&E(P,null,e.fallback);return s&&(s.__h=null),[E(P,null,t.__e?null:e.children),s]};var x=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(m.prototype=new v).__e=function(e){var t=this,n=T(t.__v),o=t.o.get(e);return o[0]++,function(s){var r=function(){t.props.revealOrder?(o.push(s),x(t,e,o)):s()};n?n(r):r()}},m.prototype.render=function(e){this.u=null,this.o=new Map;var t=g(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},m.prototype.componentDidUpdate=m.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){x(e,n,t)})};var B=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,Z=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,I=typeof document!="undefined",J=function(e){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)};v.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(v.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var A=_.event;function q(){}function F(){return this.cancelBubble}function K(){return this.defaultPrevented}_.event=function(e){return A&&(e=A(e)),e.persist=q,e.isPropagationStopped=F,e.isDefaultPrevented=K,e.nativeEvent=e};var U={configurable:!0,get:function(){return this.class}},M=_.vnode;_.vnode=function(e){var t=e.type,n=e.props,o=n;if(typeof t=="string"){var s=t.indexOf("-")===-1;for(var r in o={},n){var i=n[r];I&&r==="children"&&t==="noscript"||r==="value"&&"defaultValue"in n&&i==null||(r==="defaultValue"&&"value"in n&&n.value==null?r="value":r==="download"&&i===!0?i="":/ondoubleclick/i.test(r)?r="ondblclick":/^onchange(textarea|input)/i.test(r+t)&&!J(n.type)?r="oninput":/^onfocus$/i.test(r)?r="onfocusin":/^onblur$/i.test(r)?r="onfocusout":/^on(Ani|Tra|Tou|BeforeInp)/.test(r)?r=r.toLowerCase():s&&Z.test(r)?r=r.replace(/[A-Z0-9]/,"-$&").toLowerCase():i===null&&(i=void 0),o[r]=i)}t=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=g(n.children).forEach(function(a){a.props.selected=o.value.indexOf(a.props.value)!=-1})),t=="select"&&o.defaultValue!=null&&(o.value=g(n.children).forEach(function(a){a.props.selected=o.multiple?o.defaultValue.indexOf(a.props.value)!=-1:o.defaultValue==a.props.value})),e.props=o,n.class!=n.className&&(U.enumerable="className"in n,n.className!=null&&(o.class=n.className),Object.defineProperty(o,"className",U))}e.$$typeof=B,M&&M(e)};var V=_.__r;_.__r=function(e){V&&V(e)};class k{constructor(t){R(this,"apiEndpoint");this.apiEndpoint=t}static async configure(t){const n=await fetch(`${t}/.well-known/configuration`);if(n.status!==200)throw Error("failed to get configuration");const o=await n.json();return new k(o.api_endpoint)}async messageTemplates(){const t=await fetch(`${this.apiEndpoint}/message/templates`,{mode:"cors",headers:{"Content-Type":"application/json"}});if(t.status!==200)throw Error("failed to get message templates");return await t.json()}async setMessage(t,n){if((await fetch(`${this.apiEndpoint}/message/set`,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({doorbell_id:t,message:n,duration_sec:60})})).status!==201)throw Error("failed to set message templates")}}const Q={host:""},ee=({doorbell_id:e})=>{const[t,n]=b(u("p",{children:"loading snapshot..."})),[o,s]=b(""),[r,i]=b([]),a="No Reaction",p=async()=>{const f=await k.configure(Q.host);n(u("img",{src:`${f.apiEndpoint}/snapshot/${e}`,alt:"Snapshot"}));const c=(await f.messageTemplates()).templates.map((d,h)=>u("button",{className:"button blue block",onClick:()=>{f.setMessage(e,d),s(d)},children:d},h));i(c)};D(()=>{r.length===0&&p().catch(console.error)},[]);const l=()=>o===""?O("div",{className:"Ringing__buttons",children:[r,u("button",{className:"button red block",onClick:()=>s(a),children:a})]}):o===a?u("div",{className:"Ringing__buttons",children:u("button",{className:"button red block active",children:o})}):u("div",{className:"Ringing__buttons",children:u("button",{className:"button blue block active",children:o})});return O("div",{className:"Ringing",children:[u("h1",{className:"Ringing__title",children:"Someone At The Door"}),u("div",{className:"Ringing__snapshot",children:t}),l()]})};export{ee as Ringing};
